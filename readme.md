# REST API POC

This project demonstrates the development of REST API using Spring Boot and RAML

## API Spec

The api specification is present in cc-api.raml
The `raml-to-jaxrs` maven plugin is used to generate interfaces based on spec specified in the RAML file

## Project Organization

### model
The RAML file and the payload and response are defined in the `model` module.
The payload and responses are defined as `json` files

### service
This has the implementations of interfaces generated by the `raml-to-jaxrs` plugin

## Building the project

This is a maven project. Run `mvn clean install` from the root folder

## Running the project

Navigate to `service` folder and run `mvn spring-boot:run`


## POSTMAN collection

[![Run in Postman](https://run.pstmn.io/button.svg)](https://app.getpostman.com/run-collection/8f77420ffb04f5a97988)

## Testing Endpoints with cURL

1. Hello world end point
   `curl -X GET http://localhost:8080/helloWorld`
   
2. Fibonacci series end point
   `curl -X GET -H "Content-Type: application/json" http://localhost:8080/fibonacci/10`

3. External Posts service
   `curl -X GET -H "Content-Type: application/json" http://localhost:8080/external/posts`
   
4. User CRUD REST endpoints

   The application defines a `user` table in a in memory HSQLDB
   The `user` entity is defined as:
   
   ```
   CREATE TABLE user (
      id INT IDENTITY NOT NULL,
      name VARCHAR(50) NOT NULL,
      age INT NOT NULL,
      isremoved TINYINT DEFAULT 0,
      PRIMARY KEY (id)
   );
   ```
   
   a. GET user by id
      `curl -X GET -H "Content-Type: application/json" http://localhost:8080/user/0`
      
   b. GET Query users by either `name`, `age`
      `curl -X GET -H "Content-Type: application/json" http://localhost:8080/user?name=John&exactMatch=false&startAge=0&endAge=10&pageSize=10&pageNumber=0`
      
   c. DELETE user by id
      `curl -X DELETE -H "Content-Type: application/json" http://localhost:8080/user/0`
      
   d. PUT modify existing user by id
      `curl -X PUT -H "Content-Type: application/json" -d '{"name":"John Doe","age":"10"}' http://localhost:8080/user/1`
      
   e. POST create new user
      `curl -X POST -H "Content-Type: application/json" -d '{"name":"Interesting Person","age":"45"}' http://localhost:8080/user`

5. Deadlock

   a. Create a deadlock between 2 threads with a specified timeout. Time out should be between 1 and 60 seconds
      This operation is idempotent
      `curl -X GET -H "Content-Type: application/json" http://localhost:8080/deadlock/trigger/30`
      
   d. Outputs threads that are currently in a deadlock
      `curl -X GET -H "Content-Type: application/json" http://localhost:8080/deadlock/detect`
      
   






